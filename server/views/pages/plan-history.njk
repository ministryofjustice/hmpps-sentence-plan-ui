{% from "govuk/components/details/macro.njk" import govukDetails %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% extends "../partials/layout.njk" %}

{% block pageTitle %}
    {% if not errors %}
        {{ locale.page.title }}
    {% else %}
        {{ locale.page.errorTitle }}
    {% endif %}
{% endblock %}

{% set mainClasses = "app-container govuk-body" %}

{% block content %}
    <div class="govuk-grid-row">
        <h1 class="govuk-heading-l govuk-!-margin-bottom-2">{{ locale.mainHeading.title }}</h1>
    </div>
    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
    <p>View all updates and changes made to this plan</p>

    {% for note in data.notes %}
        {% set locale = interpolate(locale, {
            noteCreatedDate: note.createdDate | formatSimpleDate,
            noteCreatedBy: note.createdBy | convertToTitleCase
        }) %}
    <div class="govuk-grid-row govuk-!-margin-left-0">
        <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible" >
        {% if note.noteObject == 'Plan' %}
            {% if note.noteStatus == 'AGREED' %}
                <p><strong>{{ locale.note.status.plan.agreed }}</strong> {{ locale.who.practitionerAndSubject }}</p>
                <p>{{ locale.subjectResponse.agreed }}</p>
            {% elseif note.noteStatus == 'DO_NOT_AGREE' %}
                <p><strong>{{ locale.note.status.plan.created }}</strong> by {{ locale.who.practitionerOnly }}</p>
                <p>{{ locale.subjectResponse.didNotAgree }}</p>
            {% elseif note.noteStatus == 'COULD_NOT_ANSWER' %}
                <p><strong>{{ locale.note.status.plan.created }}</strong> {{ locale.who.practitionerOnly }}</p>
                <p>{{ locale.subjectResponse.couldNotAgree }}</p>
            {% endif %}

            <div>
                {{ note.note }}
            </div>

            {% if note.additionalNote %}
                {{ note.additionalNote }}
            {% endif %}

        {% endif %}

{#        {% if note.noteObject == 'Goal' %}#}
{#            {% if data.status and data.status in ['added', 'changed', 'removed', 'deleted', 'achieved'] %}#}
{#            {% if goal is CREATED %}#}
                <p><strong>{{ locale.note.status.goal.created }}</strong> {{ locale.who.practitionerOnly }}</p>
                <P><strong>{{ note.goalTitle }}</strong></P>
                <p><a href='#' class="govuk-link govuk-link--no-visited-state">{{ locale.linkType.latest }}</a></p>
{#            {% elseif goal is added back%} to update when functionality is added#}
            {#  {% elseif goal is REMOVED%}#}
                <p><strong>{{ locale.note.status.goal.removed }}</strong> {{ locale.who.practitionerOnly }}</p>
                <P><strong>{{ note.goalTitle }}</strong></P>
                {#                <p>{{ note.note }}</p> NOT SURE ABOUT THIS#}
                <p><a href='#' class="govuk-link govuk-link--no-visited-state">{{ locale.linkType.latest }}</a></p>
            {#  {% elseif goal is ACHIEVED%}#}
                <p><strong>{{ locale.note.status.goal.achieved }}</strong> {{ locale.who.practitionerOnly }}</p>
                <P><strong>{{ note.goalTitle }}</strong></P>
                    {% if note.note.length > 0 %}
                        {#   <p>{{ note.note }}</p> NOT SURE ABOUT THIS#}
                    {% endif %}
                <p><a href='#' class="govuk-link govuk-link--no-visited-state">{{ locale.linkType.direct }}</a></p>
                {#  {% elseif goal is UPDATED%}#}
                <p><strong>{{ locale.note.status.goal.updated }}</strong> {{ locale.who.practitionerOnly }}</p>
                <P><strong>{{ note.goalTitle }}</strong></P>
                    {% if note.note.length > 0 %}
                {# <p>{{ note.note }}</p> NOT SURE ABOUT THIS#}
                    {% endif %}
                <p><a href='#' class="govuk-link govuk-link--no-visited-state">{{ locale.linkType.latest }}</a></p>
{#        {% endif %}#}
{#        {% endif %}#}
    </div>
    {% endfor %}

{% endblock %}



